"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[267],{1548:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>h});var n=i(3274),s=i(9128);const o={description:"Few tips on how to avoid some of NestJS performance bottlenecks",slug:"why-you-should-kick-idle-users-out-of-your-website",authors:["fcmam5"],tags:["backend","frontend","security","privacy","development"]},r="Why you should kick idle users out of your website",a={permalink:"/blog/why-you-should-kick-idle-users-out-of-your-website",source:"@site/blog/2023-12-25-kicking-idle-users/index.md",title:"Why you should kick idle users out of your website",description:"Few tips on how to avoid some of NestJS performance bottlenecks",date:"2023-12-25T00:00:00.000Z",formattedDate:"December 25, 2023",tags:[{label:"backend",permalink:"/blog/tags/backend"},{label:"frontend",permalink:"/blog/tags/frontend"},{label:"security",permalink:"/blog/tags/security"},{label:"privacy",permalink:"/blog/tags/privacy"},{label:"development",permalink:"/blog/tags/development"}],readingTime:5.33,hasTruncateMarker:!0,authors:[{name:"Abdeldjalil Fortas",title:"A part-time Karantika lover",url:"https://github.com/fcmam5",imageURL:"https://github.com/fcmam5.png",key:"fcmam5"}],frontMatter:{description:"Few tips on how to avoid some of NestJS performance bottlenecks",slug:"why-you-should-kick-idle-users-out-of-your-website",authors:["fcmam5"],tags:["backend","frontend","security","privacy","development"]},unlisted:!1,nextItem:{title:"Avoiding NestJS performance bottlenecks",permalink:"/blog/avoiding-nestjs-performance-bottlenecks"}},l={authorsImageUrls:[void 0]},h=[{value:"The \u201cWHY\u201d?",id:"the-why",level:2},{value:"0. Privacy",id:"0-privacy",level:3},{value:"1. Security",id:"1-security",level:3},{value:"2. Resource management",id:"2-resource-management",level:3},{value:"3. Compliance and regulations",id:"3-compliance-and-regulations",level:3},{value:"4. Getting &quot;better&quot; analytics",id:"4-getting-better-analytics",level:3},{value:"The \u201cHow\u201d?",id:"the-how",level:2},{value:"A word on Hamid.js",id:"a-word-on-hamidjs",level:3},{value:"Final thoughts",id:"final-thoughts",level:2}];function c(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"If you use any applications that handle sensitive information, you might already have a situation where you get a countdown before you get logged off, this happens if you don\u2019t interact with the website after a certain (short) period."}),"\n",(0,n.jsx)(t.p,{children:"Streaming platforms also ask you if you are still watching before they stop the video or navigate to the next episode."}),"\n",(0,n.jsx)(t.p,{children:"Does this feature harm the user experience? Or does it improve it?\nIs it really necessary? This will bring more complexity to implement, test, and maintain."}),"\n",(0,n.jsx)(t.p,{children:"Or seriously, when this feature is a must-have and how to present it in the least frustrating format to the users."}),"\n",(0,n.jsx)(t.p,{children:"What if the user wants to disable this feature?"}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(t.p,{children:"Of course, the answer to all those questions is: It depends."}),"\n",(0,n.jsx)(t.p,{children:"Let me enumerate some arguments and situations where force-logging off the users would be needed."}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:"TLDR; Regulations, to protect user privacy, for security reasons, possibly for your resource management and for keeping meaningful analytics."}),"\n"]}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsxs)(t.p,{children:["I published this article previously on Medium: ",(0,n.jsx)(t.a,{href:"https://medium.com/@Fcmam5/why-you-should-kick-idle-users-out-of-your-website",children:"Why you should kick idle users out of your website"})]})}),"\n",(0,n.jsx)(t.h2,{id:"the-why",children:"The \u201cWHY\u201d?"}),"\n",(0,n.jsx)(t.p,{children:"If we understand the arguments to do this, we may decide if we should care to implement this or not."}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Spoiler alert:"})," No you don\u2019t have to do it always, just use short-lived authentication sessions/tokens."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"0-privacy",children:"0. Privacy"}),"\n",(0,n.jsx)(t.p,{children:"Users might not follow basic cyber hygiene principles, leaving their devices unlocked and unattended. They may keep their browser tab open to your super-sensitive website. Any unauthorized access to their devices means definite access to their open accounts and active sessions."}),"\n",(0,n.jsx)(t.p,{children:"If your super-sensitive website implements a feature that checks if the user is idle and logs them out, you might reduce the risk of having unauthorized access or leaking sensitive information from your user\u2019s account."}),"\n",(0,n.jsx)(t.h3,{id:"1-security",children:"1. Security"}),"\n",(0,n.jsx)(t.p,{children:"Unauthorized access to one of the users\u2019 accounts may not only cause harm to their data, but it would also be a risk to other users as threat actors will use their victim\u2019s persona/account in their actions."}),"\n",(0,n.jsx)(t.p,{children:"That also may put your application at a higher risk as you\u2019ll have to deal with users who already are one step further in your system, and who already have valid authentication tokens and valid external-facing API keys. That would expose them to more features of your application and possibly a larger attack surface."}),"\n",(0,n.jsx)(t.h3,{id:"2-resource-management",children:"2. Resource management"}),"\n",(0,n.jsxs)(t.p,{children:["You probably saw a prompt on ",(0,n.jsx)(t.a,{href:"https://help.netflix.com/en/node/114059",children:"Netflix"})," or ",(0,n.jsx)(t.a,{href:"https://support.google.com/youtube/answer/12819304?hl=en",children:"YouTube"})," asking you if you are still watching a video. Or you get a refresh button in your favorite social media platform to refresh content (or login again) after being AFK for a while."]}),"\n",(0,n.jsx)(t.p,{children:"Streaming content is expensive, and it puts a load on both the backend and heavy clients."}),"\n",(0,n.jsx)(t.p,{children:"No one wants to maintain multiple open connections from their load balancers to users who are not consuming content."}),"\n",(0,n.jsx)(t.h3,{id:"3-compliance-and-regulations",children:"3. Compliance and regulations"}),"\n",(0,n.jsx)(t.p,{children:"It is no surprise, that regulators require logging off inactive users after a moment of inactivity. For example, PSD 2 regulation for example requires logging out the user if they\u2019re inactive for 5 minutes:"}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:(0,n.jsxs)(t.em,{children:["The automatic logout after five minutes of inactivity is a regulatory requirement for banks and payment service providers under the PSD 2 regulation to increase security in online banking. See article 4(3)(d) of the DELEGATED REGULATION (EU) 2018/389 (RTS), ",(0,n.jsx)(t.a,{href:"https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32018R0389&from=EN",children:"https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32018R0389&from=EN"})," (\u201cthe maximum time without activity by the payer after being authenticated for accessing its payment account online shall not exceed 5 minutes.\u201d). [",(0,n.jsx)(t.a,{href:"https://cbportal.commerzbank.com/portal/en/fi/de/system-1/zahlungsdiensterichtlinie_2.html",children:"commerzbank"}),"]"]})}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"This imposes on payment services to implement this feature to be compliant, which is a non-negotiable argument."}),"\n",(0,n.jsx)(t.h3,{id:"4-getting-better-analytics",children:'4. Getting "better" analytics'}),"\n",(0,n.jsx)(t.p,{children:"User session times, length of videos watched, number of active users, and similar metrics might give valuable information on how clients are consuming your products and/or using your platform."}),"\n",(0,n.jsx)(t.h2,{id:"the-how",children:"The \u201cHow\u201d?"}),"\n",(0,n.jsx)(t.p,{children:"Throughout the article I used \u201cthe feature\u201d or \u201ckick the user if they\u2019re idle\u201d or similar expressions."}),"\n",(0,n.jsxs)(t.p,{children:["This feature can be implemented on both the backend and/or front-end. On the backend, you would invalidate idle user sessions (see ",(0,n.jsx)(t.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#idle-timeout",children:"OWASP recommendation"}),")."]}),"\n",(0,n.jsx)(t.p,{children:"The front-end solution would be done by capturing each user\u2019s activity through events like:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Key presses"}),"\n",(0,n.jsx)(t.li,{children:"Mouse move"}),"\n",(0,n.jsx)(t.li,{children:"Clicking"}),"\n",(0,n.jsx)(t.li,{children:"Scrolling"}),"\n",(0,n.jsx)(t.li,{children:"Window resize"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Then have a timer that we actively reset when the user is active (reset the timer if a new event is triggered)."}),"\n",(0,n.jsxs)(t.p,{children:["This part can be easily implemented from scratch (as you already know), or by using the ",(0,n.jsxs)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Idle_Detection_API",children:["new ",(0,n.jsx)(t.strong,{children:"experimental"})," browser idle APIs"]}),", or ",(0,n.jsx)(t.a,{href:"https://www.npmjs.com/package/hamid.js",children:"hamid.js"})," library (more on this later)."]}),"\n",(0,n.jsx)(t.p,{children:"If a user is idle, there should be presented a prompt component with a timer to remind them to react in case they want to keep their session open."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/business-applications-release-notes/april19/dynamics365-finance-operations/alert-user-before-session-ends",children:(0,n.jsx)(t.img,{alt:"Idle prompt from Microsoft Dynamics 365",src:i(8211).A+"",width:"554",height:"314"})})}),"\n",(0,n.jsx)(t.p,{children:"If they are logged off, it would be beneficial to present them with a flash message to inform them that they were logged off."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"ELSTER (online German tax office) example",src:i(8874).A+"",width:"1400",height:"412"})}),"\n",(0,n.jsx)(t.p,{children:"A similar alert would train the users on the \u201cbest practices\u201d."}),"\n",(0,n.jsx)(t.h3,{id:"a-word-on-hamidjs",children:"A word on Hamid.js"}),"\n",(0,n.jsxs)(t.p,{children:["A couple of months ago I wrote ",(0,n.jsx)(t.a,{href:"https://github.com/Fcmam5/hamid.js",children:"Hamid.js"}),", a lightweight open-source library to trigger actions if a user is inactive."]}),"\n",(0,n.jsx)(t.p,{children:"For example, if you want to logout a user after 5 minutes of being inactive:"}),"\n",(0,n.jsx)("iframe",{height:"300",width:"100%",scrolling:"no",title:"Hamid.js",src:"https://codepen.io/Fcmam5/embed/mdodKVN?default-tab=html%2Cresult",frameborder:"no",loading:"lazy",allowtransparency:"true",allowfullscreen:"true",children:(0,n.jsxs)(t.p,{children:["See the Pen ",(0,n.jsx)("a",{href:"https://codepen.io/Fcmam5/pen/mdodKVN",children:"\nHamid.js"})," by Fortas Abdeldjalil (",(0,n.jsx)("a",{href:"https://codepen.io/Fcmam5",children:"@Fcmam5"}),")\non ",(0,n.jsx)("a",{href:"https://codepen.io",children:"CodePen"}),"."]})}),"\n",(0,n.jsxs)(t.p,{children:["The library listens by default to a ",(0,n.jsx)(t.a,{href:"https://github.com/Fcmam5/hamid.js/blob/127b7b5d7f66aa2ffa922695589737ff8b7b0904/src/lib.ts#L35",children:"set of events"})," to determine if the user is active, if none of these events is triggered within the configured time interval (second ",(0,n.jsx)(t.code,{children:"Hamid"})," constructor parameter, or 5mins by default), the callback we provide as a first parameter will be triggered."]}),"\n",(0,n.jsx)(t.p,{children:"The library will be improved and possibly rewritten to be extensible to support more than web browsers\u2019 events. Of course, all PRs and contributions are welcome!"}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:"The name is inspired from an Algerian meme originated from a comedy show where a bus driver asked his ticketsman to kick someone else from the bus by saying: Hamid, Serhah (release him)."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Bila Houdoud: Hamid Serhah",src:i(454).A+"",width:"640",height:"358"})}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"final-thoughts",children:"Final thoughts"}),"\n",(0,n.jsx)(t.p,{children:"In some cases, we would sacrifice having a \u201cseamless\u201d user-experience and easier implementations to provide the users something that we consider better, or at least, more secure."}),"\n",(0,n.jsx)(t.p,{children:"This article is based on my experience as a developer, and as a lazy user, I hope it receives feedback from smarter people and hopefully, we enrich it together."})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8874:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/elster-1ee6af6a96f1cb880219ce9a2a96e074.png"},454:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/hamid-ser7ah-fa2c62e378bc1842c4691f94d15609bb.gif"},8211:(e,t,i)=>{i.d(t,{A:()=>n});const n=i.p+"assets/images/ms-idle-prompt-847eceb6a86a93631a63c4417189c2c3.png"},9128:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var n=i(9474);const s={},o=n.createContext(s);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);