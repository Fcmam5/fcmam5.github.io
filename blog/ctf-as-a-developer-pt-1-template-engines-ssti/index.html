<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">CTF as a developer (Pt. 1): Template engines &amp; SSTI | Abdeldjalil Fortas&#x27; notepad</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://fcmam5.me/img/karantika.png"><meta data-rh="true" name="twitter:image" content="https://fcmam5.me/img/karantika.png"><meta data-rh="true" property="og:url" content="https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="CTF as a developer (Pt. 1): Template engines &amp; SSTI | Abdeldjalil Fortas&#x27; notepad"><meta data-rh="true" name="description" content="Learning about cybersecurity as a developer by playing CTF (Part1: Template engines and SSTI)"><meta data-rh="true" property="og:description" content="Learning about cybersecurity as a developer by playing CTF (Part1: Template engines and SSTI)"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-09-07T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/fcmam5"><meta data-rh="true" property="article:tag" content="backend,cybersecurity,frontend"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti"><link data-rh="true" rel="alternate" href="https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti" hreflang="en"><link data-rh="true" rel="alternate" href="https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti","mainEntityOfPage":"https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti","url":"https://fcmam5.me/blog/ctf-as-a-developer-pt-1-template-engines-ssti","headline":"CTF as a developer (Pt. 1): Template engines & SSTI","name":"CTF as a developer (Pt. 1): Template engines & SSTI","description":"Learning about cybersecurity as a developer by playing CTF (Part1: Template engines and SSTI)","datePublished":"2023-09-07T00:00:00.000Z","author":{"@type":"Person","name":"Abdeldjalil Fortas","description":"A part-time Karantika lover","url":"https://github.com/fcmam5","image":"https://github.com/fcmam5.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://fcmam5.me/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Abdeldjalil Fortas&#39; notepad RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Abdeldjalil Fortas&#39; notepad Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6WM7E899MF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6WM7E899MF",{anonymize_ip:!0})</script>



<link rel="alternate" type="application/rss+xml" href="/snippets/rss.xml" title="Abdeldjalil Fortas&#39; notepad RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/snippets/atom.xml" title="Abdeldjalil Fortas&#39; notepad Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/dz-blog/rss.xml" title="Abdeldjalil Fortas&#39; notepad RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dz-blog/atom.xml" title="Abdeldjalil Fortas&#39; notepad Atom Feed"><link rel="stylesheet" href="/assets/css/styles.313eda76.css">
<script src="/assets/js/runtime~main.b551b3da.js" defer="defer"></script>
<script src="/assets/js/main.285be8a2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_w4bG" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_nsx8 themedComponent--light_tMDM"><img src="/img/apple-touch-icon.png" alt="My Site Logo" class="themedComponent_nsx8 themedComponent--dark_j9qU"></div><b class="navbar__title text--truncate">Fcmam5</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/snippets">Snippets</a><a class="navbar__item navbar__link" href="/dz-blog">&lt;DZ /&gt;</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/fcmam5" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_gvNZ colorModeToggle_vcoM"><button class="clean-btn toggleButton_jD0e toggleButtonDisabled_SLer" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_DYzy"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_Toj6"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_ntII"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_p4bb"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_Mxr5 thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_jpjJ margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_W_m9">2024</h3><ul class="sidebarItemList_Kbb0 clean-list"><li class="sidebarItem_V98s"><a class="sidebarItemLink_zjL5" href="/blog/breaking-cors-by-fixing-it">Breaking CORS by &quot;trying to fix it&quot;</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_W_m9">2023</h3><ul class="sidebarItemList_Kbb0 clean-list"><li class="sidebarItem_V98s"><a class="sidebarItemLink_zjL5" href="/blog/why-you-should-kick-idle-users-out-of-your-website">Why you should kick idle users out of your website</a></li><li class="sidebarItem_V98s"><a class="sidebarItemLink_zjL5" href="/blog/avoiding-nestjs-performance-bottlenecks">Avoiding NestJS performance bottlenecks</a></li><li class="sidebarItem_V98s"><a aria-current="page" class="sidebarItemLink_zjL5 sidebarItemLinkActive_sPi5" href="/blog/ctf-as-a-developer-pt-1-template-engines-ssti">CTF as a developer (Pt. 1): Template engines &amp; SSTI</a></li><li class="sidebarItem_V98s"><a class="sidebarItemLink_zjL5" href="/blog/trying-to-become-a-better-developer-by-learning-more-about-aviation">Trying to become a better developer by learning more about aviation</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_W_m9">2018</h3><ul class="sidebarItemList_Kbb0 clean-list"><li class="sidebarItem_V98s"><a class="sidebarItemLink_zjL5" href="/blog/learning-front-end-development-again-part-1-browser-rendering-optimization">I’m learning front-end development, again — Part 1 (Browser rendering optimization)</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_dh4i">CTF as a developer (Pt. 1): Template engines &amp; SSTI</h1><div class="container_x8aW margin-vert--md"><time datetime="2023-09-07T00:00:00.000Z">September 7, 2023</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Mbfq"><div class="avatar margin-bottom--sm"><a href="https://github.com/fcmam5" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_idZm" src="https://github.com/fcmam5.png" alt="Abdeldjalil Fortas"></a><div class="avatar__intro authorDetails_FV8h"><div class="avatar__name"><a href="https://github.com/fcmam5" target="_blank" rel="noopener noreferrer"><span class="authorName_vlvj">Abdeldjalil Fortas</span></a></div><small class="authorTitle_LdE4" title="A part-time Karantika lover">A part-time Karantika lover</small><div class="authorSocials_zoso"><a href="https://x.com/fcmam5" target="_blank" rel="noopener noreferrer" class="authorSocialLink__nQM" title="X"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 1200 1227" style="--dark:#000;--light:#fff" class="authorSocialLink__nQM xSvg_wUce"><path d="M714.163 519.284 1160.89 0h-105.86L667.137 450.887 357.328 0H0l468.492 681.821L0 1226.37h105.866l409.625-476.152 327.181 476.152H1200L714.137 519.284h.026ZM569.165 687.828l-47.468-67.894-377.686-540.24h162.604l304.797 435.991 47.468 67.894 396.2 566.721H892.476L569.165 687.854v-.026Z"></path></svg></a><a href="https://github.com/fcmam5" target="_blank" rel="noopener noreferrer" class="authorSocialLink__nQM" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink__nQM githubSvg_LMGL"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Being a software developer is a responsibility, it’s a job where we provide secure and stable services and infrastructure to users who trust us (or trust regulations that ensure we are trustworthy).</p>
<p>To learn more about cybersecurity principles, and why some “best practices” matter, I decided to play some CTF challenges instead of only relying on reading articles and scrolling into OWASP top 10’s documentation.</p>
<p>My beginning was with HackTheBox. For some reason, some of the challenges I did had <a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server-side_Template_Injection" target="_blank" rel="noopener noreferrer">Server-side Template Injection (SSTI)</a> vulnerabilities which I’m starting this blog series with.</p>
<blockquote>
<p>If you are a security professional or an experienced programmer this article might not bring you anything new, feel free to stop reading now, but I would appreciate your inputs, corrections and guidance!</p>
</blockquote>
<div class="theme-admonition theme-admonition-note admonition_X73N alert alert--secondary"><div class="admonitionHeading_Bmo7"><span class="admonitionIcon_vKgX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BhkU"><p>I published this article previously on Medium: <a href="https://medium.com/@Fcmam5/ctf-as-a-developer-pt-1-template-engines-ssti-b03c59e2c095" target="_blank" rel="noopener noreferrer">CTF as a developer (Pt. 1): Template engines &amp; SSTI</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_wshO" id="what-are-template-engines">What are template engines?<a href="#what-are-template-engines" class="hash-link" aria-label="Direct link to What are template engines?" title="Direct link to What are template engines?">​</a></h2>
<p>Template engines are tools that facilitate rendering content for web applications by injecting data into static templates.</p>
<p>Template engines like <a href="https://github.com/pallets/jinja" target="_blank" rel="noopener noreferrer">Jinja</a>, <a href="https://handlebarsjs.com/" target="_blank" rel="noopener noreferrer">Handlebars</a>, <a href="https://ejs.co/" target="_blank" rel="noopener noreferrer">EJS</a>, or PHP’s <a href="https://twig.symfony.com/" target="_blank" rel="noopener noreferrer">Twig</a> provide more features for developers to add more logic (with variables, functions, loops, etc.) to templates which makes development and maintenance easier.</p>
<h2 class="anchor anchorWithStickyNavbar_wshO" id="server-side-template-injection-ssti-vulnerabilities">Server-side template injection (SSTI) vulnerabilities<a href="#server-side-template-injection-ssti-vulnerabilities" class="hash-link" aria-label="Direct link to Server-side template injection (SSTI) vulnerabilities" title="Direct link to Server-side template injection (SSTI) vulnerabilities">​</a></h2>
<p>Consider this simple, and ugly app that greets the user every time they visit our <code>/greeting/&lt;name&gt;</code> route:</p>
<div class="language-python codeBlockContainer_mjgO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_G6bz"><pre tabindex="0" class="prism-code language-python codeBlock_EM2m thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Wjdm"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flask </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Flask</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> render_template_string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> random </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> choice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/greeting/&lt;name&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">greeting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    greeting </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> choice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Hi&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Welcome&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    template </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &lt;title&gt;Greeting&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &lt;h1&gt;&#x27;&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> greeting </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;!&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;/html&gt;&#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> render_template_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">template</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">debug</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8080</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_iswC"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_owJ3" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Y6Z1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_yjit"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For example, <code>GET /greeting/Alice</code> would show:</p>
<p><img decoding="async" loading="lazy" alt="Example page" src="/assets/images/tpl-1-9c68e0c2241aaf03e3a954ab3f91d453.png" width="720" height="260" class="img_IhjM"></p>
<p>Now that we (or attackers) know that we are passing a user-provided variable to the template, we can experiment by passing a Jinja2 expression <code>{{ 2 + 2 }}</code>. In my case that would show:</p>
<p><img decoding="async" loading="lazy" alt="Template injection example" src="/assets/images/tpl-2-0d98ae8f0248cec44074fab07fb3b902.png" width="720" height="183" class="img_IhjM"></p>
<p>This means that the expression was evaluated as a Jinja template, which means that attackers can inject Python code that can do anything, for example running an <code>ls -R</code> on the application server’s shell with an expression like the following:</p>
<div class="language-python codeBlockContainer_mjgO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_G6bz"><pre tabindex="0" class="prism-code language-python codeBlock_EM2m thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Wjdm"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">application</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__globals__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__builtins__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">__import__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;os&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">popen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ls -R&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_iswC"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_owJ3" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Y6Z1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_yjit"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Which will show:</p>
<p><img decoding="async" loading="lazy" alt="ls -R" src="/assets/images/ls-r-injection-d7641ae71a43a620f8321fdc4e8d0ed0.png" width="1264" height="326" class="img_IhjM"></p>
<p>Attackers can be creative from here, they can run any command to upload/download more malicious scripts to our application servers which will give them more access and make things far easier for them.</p>
<p>The risks of such an attack are high, especially since even skiddies may use free scripts and tools that are available online to scan and exploit websites. The magical command:</p>
<div class="language-python codeBlockContainer_mjgO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_G6bz"><pre tabindex="0" class="prism-code language-python codeBlock_EM2m thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Wjdm"><span class="token-line" style="color:#393A34"><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">application</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__globals__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__builtins__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">__import__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;os&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">popen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ls -R&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_iswC"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_owJ3" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Y6Z1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_yjit"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Can be found in serval blogs online along with other tricks for more powerful exploits. That means that anyone can exploit it, so please let’s take it seriously.</p>
<p>Security professionals and threat actors also rely on tools (such as <a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener noreferrer">tplmap</a>) to find and exploit real-world applications, which makes SSTI vulnerabilities critical to solve as they might be easy to find and exploit.</p>
<h2 class="anchor anchorWithStickyNavbar_wshO" id="why-should-i-even-care">Why should I even care?<a href="#why-should-i-even-care" class="hash-link" aria-label="Direct link to Why should I even care?" title="Direct link to Why should I even care?">​</a></h2>
<p>Even if you are building a small side-project, you really have to not neglect basic security aspects.</p>
<p>Threat actors may use your applications’ servers as nodes in their botnets, or use them as proxies when performing attacks on more critical targets.
Or they would make your application server into a crypto-miner, or a platform to run their CPU-expensive applications.</p>
<p>You really don’t want to have unnecessary cost and legal implications for just neglecting good practices.</p>
<h2 class="anchor anchorWithStickyNavbar_wshO" id="remediation">Remediation<a href="#remediation" class="hash-link" aria-label="Direct link to Remediation" title="Direct link to Remediation">​</a></h2>
<p>There are plenty of articles online by security professionals who’d tell you how to protect yourself from SSTI and this one would only give typical recommendations:</p>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="never-trust-client-side-validation">NEVER trust client-side validation<a href="#never-trust-client-side-validation" class="hash-link" aria-label="Direct link to NEVER trust client-side validation" title="Direct link to NEVER trust client-side validation">​</a></h3>
<p>Client-side validation is for real application users, it offers guidance and early feedback if they insert any invalid input. It can never block any attack as it can easily bypassed with different techniques.</p>
<p><img decoding="async" loading="lazy" alt="Programmerhummor: Client-side validation" src="/assets/images/client-side-validation-a9874f37922099edca00ca12cf2adefe.png" width="480" height="270" class="img_IhjM"></p>
<p>As trivial as it sounds to any experienced developer or any security professional reading this, we still can find unprotected endpoints.</p>
<p>The absence of server-side validation might happen if applications are built by inexperienced and junior developers (WRITING about it, since I’m guilty of this), or it may also happen correctly if front-end and backend developers are not aligned which would produce inconsistencies in validation rules.</p>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="use-well-maintained-and-known-template-engines">Use well-maintained and known template engines<a href="#use-well-maintained-and-known-template-engines" class="hash-link" aria-label="Direct link to Use well-maintained and known template engines" title="Direct link to Use well-maintained and known template engines">​</a></h3>
<p>Sometimes <a href="https://en.wikipedia.org/wiki/Linus%27s_law" target="_blank" rel="noopener noreferrer">Linus’s law</a> applies; given enough eyeballs looking at a particular code, bugs and security issues will be discovered.</p>
<p>Template engines like Jinja, EJS, or Twig are maintained by many smart developers who try to maintain them while keeping them safe.</p>
<p>If you are working on an application that would go to production, consider using stable and well-maintained libraries and keeping them up-to-date as they will always provide patches to any possible CVEs.</p>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="read-the-documentation">Read the documentation<a href="#read-the-documentation" class="hash-link" aria-label="Direct link to Read the documentation" title="Direct link to Read the documentation">​</a></h3>
<p>Good libraries are well-documented by the people who built them, and who are using them. You should always rely on the official documentation and not only blog articles and copying around code snippets from StackOverflow or some AI-generated tools.</p>
<p>Sometimes, defaults are evil, and sometimes they are “the safest” option. Only a wise developer can understand how things work and how they should be used.</p>
<p>For example, my previous demo wouldn’t work if I just used <a href="https://flask.palletsprojects.com/en/2.3.x/api/#flask.render_template_string" target="_blank" rel="noopener noreferrer">flask.render_template_string</a> correctly by passing my variables as parameters and letting it synthesize the rendered expression</p>
<div class="language-python codeBlockContainer_mjgO theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_G6bz"><pre tabindex="0" class="prism-code language-python codeBlock_EM2m thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Wjdm"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">greeting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    greeting </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> choice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Hi&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Welcome&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    template </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &lt;title&gt;Greeting&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &lt;h1&gt; {{ greeting }} {{ name }}!&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &lt;/html&gt;&#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> render_template_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">template</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> greeting</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">greeting</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_iswC"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_owJ3" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Y6Z1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_yjit"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then the passed value will be synthesized, and rendered as a string</p>
<p><img decoding="async" loading="lazy" alt="Sanitized output" src="/assets/images/sanized-output-9a7d0b45430fd205210b3ef5c59baa7a.png" width="1314" height="294" class="img_IhjM"></p>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="sanitizing-inputs">Sanitizing inputs<a href="#sanitizing-inputs" class="hash-link" aria-label="Direct link to Sanitizing inputs" title="Direct link to Sanitizing inputs">​</a></h3>
<p>Not trusting any user-provided input by validating and sanitizing is a general rule when building applications.</p>
<p>One other piece of advice is to use libraries, and not overengineer another sanitization and/or validation library unless you have a very specific use case and enough resources to build it. It is hard to list and cover all possible scenarios and tricks by yourself.</p>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="dont-guide-attackers">Don’t guide attackers<a href="#dont-guide-attackers" class="hash-link" aria-label="Direct link to Don’t guide attackers" title="Direct link to Don’t guide attackers">​</a></h3>
<p>Unless you reveal your technology stack or maintain an open-source application, attackers will scan your application to find which technology you are using before they try to exploit it.</p>
<p>There are plenty of template engines out there, and only by finding which technology is used in rendering them, attackers will save a lot of time that we would take in scanning and brute-forcing.</p>
<p>To hide which backend technology is used in your backend, or at least your front-end rendering service, we can follow these recommendations:</p>
<ul>
<li>Make sure to not log any debug messages on the front-end and disable debug mode in your framework.</li>
<li>Use non-standard framework error pages/messages, consider catching errors and returning your custom error pages. You can make them static (not rendering any variable or expression) unless you can really justify it.</li>
<li>Remove <code>X-Powered-By</code>, <code>Server</code>, and any other HTTP headers that would expose your application server (e.g. <code>X-AspNet-Version</code>), or just a library like <a href="https://helmetjs.github.io/" target="_blank" rel="noopener noreferrer">Helmet</a> for Node.js.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="do-not-trust-your-client-facing-renderer-application">Do not trust your client-facing renderer application<a href="#do-not-trust-your-client-facing-renderer-application" class="hash-link" aria-label="Direct link to Do not trust your client-facing renderer application" title="Direct link to Do not trust your client-facing renderer application">​</a></h3>
<p>If you are working on a critical application, you might be already applying a zero-trust system which would also affect your application deployment and architecture.</p>
<p>In case your renderer application is containerized, you can consider using distroless images which is a minimalistic setup for your application (removing shell and its utilities) which would limit what can be done if someone took over your application.</p>
<p>Running application processes as a non-root user, and having its filesystem set to read-only in addition to limiting its network access to internal infrastructure.</p>
<p>That may protect the infrastructure from having a backdoor in the renderer.</p>
<h2 class="anchor anchorWithStickyNavbar_wshO" id="final-thoughts">Final thoughts<a href="#final-thoughts" class="hash-link" aria-label="Direct link to Final thoughts" title="Direct link to Final thoughts">​</a></h2>
<p>We humans are the most vulnerable piece of any complex software system. We can introduce serious security flaws by being lazy or not taking things seriously or by sacrificing best practices for the sake of speed of delivery.</p>
<p>SSTI is an example of vulnerabilities that might be easy to avoid by just educating ourselves that it’s a risk, by spending some time adapting well-maintained templating engines and keeping them up-to-date or at least updating them when security patches are released.</p>
<p>Adapting templating engines should be done with best practices and security by default. Then developers should have a good code review culture to make sure that libraries are used and configured as they should be.</p>
<p>If you are reading this blog and you are also one of us, who only learn by doing and by breaking things, have a look at these challenges from HackThe box:</p>
<ul>
<li><a href="https://app.hackthebox.com/challenges/395" target="_blank" rel="noopener noreferrer">https://app.hackthebox.com/challenges/395</a></li>
<li><a href="https://app.hackthebox.com/challenges/152" target="_blank" rel="noopener noreferrer">https://app.hackthebox.com/challenges/152</a></li>
</ul>
<p>Or, you can use these applications that are explicitly made to be vulnerable:</p>
<ul>
<li><a href="https://owasp.org/www-project-juice-shop/" target="_blank" rel="noopener noreferrer">https://owasp.org/www-project-juice-shop/</a></li>
<li><a href="https://github.com/OWASP/NodeGoat" target="_blank" rel="noopener noreferrer">https://github.com/OWASP/NodeGoat</a></li>
<li><a href="https://github.com/appsecco/dvna" target="_blank" rel="noopener noreferrer">https://github.com/appsecco/dvna</a></li>
<li><a href="https://github.com/CTFd/CTFd" target="_blank" rel="noopener noreferrer">https://github.com/CTFd/CTFd</a></li>
</ul>
<p>Or this lab from PortSwigger’s <a href="https://portswigger.net/web-security" target="_blank" rel="noopener noreferrer">Web Security Academy</a>:</p>
<p><a href="https://portswigger.net/web-security/server-side-template-injection/exploiting" target="_blank" rel="noopener noreferrer">https://portswigger.net/web-security/server-side-template-injection/exploiting</a></p>
<h3 class="anchor anchorWithStickyNavbar_wshO" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h3>
<ul>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server-side_Template_Injection" target="_blank" rel="noopener noreferrer">https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/18-Testing_for_Server-side_Template_Injection</a></li>
<li><a href="https://www.vaadata.com/blog/server-side-template-injection-vulnerability-what-it-is-how-to-prevent-it/" target="_blank" rel="noopener noreferrer">https://www.vaadata.com/blog/server-side-template-injection-vulnerability-what-it-is-how-to-prevent-it/</a></li>
<li><a href="https://portswigger.net/research/server-side-template-injection" target="_blank" rel="noopener noreferrer">https://portswigger.net/research/server-side-template-injection</a></li>
</ul></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_rM4s padding--none margin-left--sm"><li class="tag_gy0V"><a class="tag_NNd9 tagRegular_xb28" href="/blog/tags/backend">backend</a></li><li class="tag_gy0V"><a class="tag_NNd9 tagRegular_xb28" href="/blog/tags/cybersecurity">cybersecurity</a></li><li class="tag_gy0V"><a class="tag_NNd9 tagRegular_xb28" href="/blog/tags/frontend">frontend</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/Fcmam5/fcmam5.github.io/tree/master/portfolio/blog/2023-09-07-ctf-as-dev-1-ssti/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_iied" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_q1ta"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/avoiding-nestjs-performance-bottlenecks"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Avoiding NestJS performance bottlenecks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/trying-to-become-a-better-developer-by-learning-more-about-aviation"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Trying to become a better developer by learning more about aviation</div></a></nav></main><div class="col col--2"><div class="tableOfContents_QL7L thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-are-template-engines" class="table-of-contents__link toc-highlight">What are template engines?</a></li><li><a href="#server-side-template-injection-ssti-vulnerabilities" class="table-of-contents__link toc-highlight">Server-side template injection (SSTI) vulnerabilities</a></li><li><a href="#why-should-i-even-care" class="table-of-contents__link toc-highlight">Why should I even care?</a></li><li><a href="#remediation" class="table-of-contents__link toc-highlight">Remediation</a><ul><li><a href="#never-trust-client-side-validation" class="table-of-contents__link toc-highlight">NEVER trust client-side validation</a></li><li><a href="#use-well-maintained-and-known-template-engines" class="table-of-contents__link toc-highlight">Use well-maintained and known template engines</a></li><li><a href="#read-the-documentation" class="table-of-contents__link toc-highlight">Read the documentation</a></li><li><a href="#sanitizing-inputs" class="table-of-contents__link toc-highlight">Sanitizing inputs</a></li><li><a href="#dont-guide-attackers" class="table-of-contents__link toc-highlight">Don’t guide attackers</a></li><li><a href="#do-not-trust-your-client-facing-renderer-application" class="table-of-contents__link toc-highlight">Do not trust your client-facing renderer application</a></li></ul></li><li><a href="#final-thoughts" class="table-of-contents__link toc-highlight">Final thoughts</a><ul><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">About me</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/snippets">Snippets</a></li><li class="footer__item"><a class="footer__link-item" href="/contributions">Contributions</a></li><li class="footer__item"><a class="footer__link-item" href="/libraries">Libraries</a></li><li class="footer__item"><a href="https://www.credly.com/users/fcmam5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Creedly<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Let&#x27;s connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Fcmam5" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/users/5078746/fcmam5" target="_blank" rel="noopener noreferrer" class="footer__link-item">StackOverflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/in/fcmam5" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/Fcmam5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/@Fcmam5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_CsqB"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Abdeldjalil Fortas. Built with Docusaurus (while drinking green tea this time).</div></div></div></footer></div>
</body>
</html>